"use strict";(self.webpackChunkperga_docs=self.webpackChunkperga_docs||[]).push([[847],{2540:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"perga-api","title":"Perga API","description":"License: MIT","source":"@site/docs/perga-api.md","sourceDirName":".","slug":"/perga-api","permalink":"/docs/perga-api","draft":false,"unlisted":false,"editUrl":"https://github.com/dbtiunov/perga-docs/tree/main/docs/perga-api.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Installation","permalink":"/docs/installation"},"next":{"title":"Perga Web","permalink":"/docs/perga-web"}}');var a=s(4848),l=s(8453);const d={sidebar_position:2},r="Perga API",t={},c=[{value:"Overview",id:"overview",level:2},{value:"Features",id:"features",level:2},{value:"Demo and Documentation",id:"demo-and-documentation",level:2},{value:"Tech Stack",id:"tech-stack",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Installation (local)",id:"installation-local",level:2},{value:"Docker",id:"docker",level:2},{value:"API Documentation",id:"api-documentation",level:2},{value:"API Endpoints (v1)",id:"api-endpoints-v1",level:2},{value:"Authentication",id:"authentication",level:3},{value:"Planner Days",id:"planner-days",level:3},{value:"Agendas (monthly, custom, archived)",id:"agendas-monthly-custom-archived",level:3},{value:"Development",id:"development",level:2},{value:"Project Structure",id:"project-structure",level:3},{value:"Testing",id:"testing",level:3},{value:"Database Migrations",id:"database-migrations",level:3},{value:"License",id:"license",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"perga-api",children:"Perga API"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.img,{src:"https://img.shields.io/badge/License-MIT-blue.svg",alt:"License: MIT"}),"\n",(0,a.jsx)(n.img,{src:"https://img.shields.io/badge/python-3.10-blue.svg",alt:"Python"}),"\n",(0,a.jsx)(n.img,{src:"https://github.com/dbtiunov/perga-api/actions/workflows/ci.yml/badge.svg",alt:"Build"})]}),"\n",(0,a.jsx)(n.p,{children:"Personal organizer backend that provides the core functionality for the Perga system."}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsxs)(n.p,{children:["Perga API is a FastAPI-based backend that powers the Perga personal organizer. It exposes REST API consumed by the standalone web client ",(0,a.jsx)(n.a,{href:"./perga-web",children:"Perga Web"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Daily planner"}),"\n",(0,a.jsx)(n.li,{children:"Monthly and custom agendas"}),"\n",(0,a.jsx)(n.li,{children:"RESTful API with FastAPI"}),"\n",(0,a.jsx)(n.li,{children:"User authentication with JWT tokens"}),"\n",(0,a.jsx)(n.li,{children:"Interactive docs (Swagger UI / ReDoc)"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"demo-and-documentation",children:"Demo and Documentation"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Demo: ",(0,a.jsx)(n.a,{href:"https://demo.getperga.me/",children:"https://demo.getperga.me/"})]}),"\n",(0,a.jsxs)(n.li,{children:["Repo: ",(0,a.jsx)(n.a,{href:"https://github.com/dbtiunov/perga-api",children:"https://github.com/dbtiunov/perga-api"})]}),"\n",(0,a.jsxs)(n.li,{children:["Docs (this page): ",(0,a.jsx)(n.a,{href:"https://dbtiunov.github.io/perga-docs/docs/perga-api",children:"https://dbtiunov.github.io/perga-docs/docs/perga-api"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"tech-stack",children:"Tech Stack"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"FastAPI"}),"\n",(0,a.jsx)(n.li,{children:"SQLAlchemy"}),"\n",(0,a.jsx)(n.li,{children:"Alembic"}),"\n",(0,a.jsx)(n.li,{children:"PostgreSQL"}),"\n",(0,a.jsx)(n.li,{children:"Pydantic Settings"}),"\n",(0,a.jsx)(n.li,{children:"JWT-based auth"}),"\n",(0,a.jsx)(n.li,{children:"Pytest"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Python 3.10+"}),"\n",(0,a.jsx)(n.li,{children:"PostgreSQL 15+"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"installation-local",children:"Installation (local)"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Clone and enter the repo"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/dbtiunov/perga-api.git\ncd perga-api\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsx)(n.li,{children:"Create and activate a virtual environment"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"python -m venv .venv\nsource .venv/bin/activate   # Windows: .venv\\Scripts\\activate\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"3",children:["\n",(0,a.jsx)(n.li,{children:"Install dependencies"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"pip install -r requirements.txt\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"4",children:["\n",(0,a.jsx)(n.li,{children:"Configure environment"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cp .env.example .env\n# then edit .env\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Important variables (from ",(0,a.jsx)(n.code,{children:".env.example"}),"):"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"SECRET_KEY"})," \u2014 any secure random string"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POSTGRES_HOST"}),", ",(0,a.jsx)(n.code,{children:"POSTGRES_USER"}),", ",(0,a.jsx)(n.code,{children:"POSTGRES_PASSWORD"}),", ",(0,a.jsx)(n.code,{children:"POSTGRES_DB"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"CORS_ORIGINS"}),' \u2014 JSON array of allowed origins (e.g. ["http://localhost:5173"])']}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ROOT_URL_REDIRECT"})," \u2014 optional URL to redirect ",(0,a.jsx)(n.code,{children:"/"})," to (used by nginx demo)"]}),"\n"]}),"\n",(0,a.jsxs)(n.ol,{start:"5",children:["\n",(0,a.jsx)(n.li,{children:"Run migrations"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"alembic upgrade head\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"6",children:["\n",(0,a.jsx)(n.li,{children:"Start the app"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"uvicorn app.main:app --reload\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Base URL: ",(0,a.jsx)(n.a,{href:"http://localhost:8000",children:"http://localhost:8000"})]}),"\n",(0,a.jsxs)(n.li,{children:["Swagger UI: ",(0,a.jsx)(n.a,{href:"http://localhost:8000/docs",children:"http://localhost:8000/docs"})]}),"\n",(0,a.jsxs)(n.li,{children:["ReDoc: ",(0,a.jsx)(n.a,{href:"http://localhost:8000/redoc",children:"http://localhost:8000/redoc"})]}),"\n",(0,a.jsxs)(n.li,{children:["Health: ",(0,a.jsx)(n.code,{children:"GET /health/"})," \u2192 ",(0,a.jsx)(n.code,{children:"200 OK"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"docker",children:"Docker"}),"\n",(0,a.jsx)(n.p,{children:"A Docker Compose setup is included. It runs:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"db"}),": PostgreSQL 15"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"app"}),": the FastAPI app (exposed on host port 8000)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"nginx"}),": reverse proxy that serves the app on host port 8080"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Start/stop:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker-compose up -d\n# ...\ndocker-compose down\n"})}),"\n",(0,a.jsx)(n.p,{children:"Default ports and health:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["App direct: ",(0,a.jsx)(n.a,{href:"http://localhost:8000",children:"http://localhost:8000"})," (health: ",(0,a.jsx)(n.code,{children:"GET /health/"}),")"]}),"\n",(0,a.jsxs)(n.li,{children:["Via nginx: ",(0,a.jsx)(n.a,{href:"http://localhost:8080",children:"http://localhost:8080"})," (health inside nginx: ",(0,a.jsx)(n.code,{children:"GET /health/"}),")"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"api-documentation",children:"API Documentation"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Swagger UI: ",(0,a.jsx)(n.a,{href:"http://localhost:8080/docs",children:"http://localhost:8080/docs"})," (via nginx) or ",(0,a.jsx)(n.a,{href:"http://localhost:8000/docs",children:"http://localhost:8000/docs"})," (direct)"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"api-endpoints-v1",children:"API Endpoints (v1)"}),"\n",(0,a.jsx)(n.h3,{id:"authentication",children:"Authentication"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/auth/signup/"})," \u2014 Register a new user"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/auth/access_token/"})," \u2014 Get access token (form data)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/auth/access_token_json/"})," \u2014 Get access token (JSON)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/auth/refresh_token/"})," \u2014 Refresh access token"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"GET /api/v1/auth/user/"})," \u2014 Get current user"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"PUT /api/v1/auth/user/"})," \u2014 Update current user"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"PUT /api/v1/auth/user/password/"})," \u2014 Change password"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"planner-days",children:"Planner Days"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"GET /api/v1/planner/days/items/?days=YYYY-MM-DD&days=YYYY-MM-DD"})," \u2014 Get items for multiple days; returns a dictionary keyed by date string"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/days/items/"})," \u2014 Create a new day item"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"PUT /api/v1/planner/days/items/{item_id}/"})," \u2014 Update a day item"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"DELETE /api/v1/planner/days/items/{item_id}/"})," \u2014 Delete a day item"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/days/items/reorder/"})," \u2014 Reorder items for a day"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/days/items/{item_id}/copy/"})," \u2014 Copy a day item to another day"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/days/items/{item_id}/snooze/"})," \u2014 Snooze a day item to another day"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"agendas-monthly-custom-archived",children:"Agendas (monthly, custom, archived)"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"GET /api/v1/planner/agendas/?agenda_types=monthly&selected_day=YYYY-MM-DD&with_counts=false"})," \u2014 List agendas (filters optional)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/agendas/"})," \u2014 Create an agenda"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"PUT /api/v1/planner/agendas/{agenda_id}/"})," \u2014 Update an agenda (including archive/unarchive)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"DELETE /api/v1/planner/agendas/{agenda_id}/"})," \u2014 Delete an agenda"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/agendas/reorder/"})," \u2014 Reorder agendas"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/agendas/{agenda_id}/action/"})," \u2014 Perform an action on agenda (e.g., resolve monthly)"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Agenda items:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"GET /api/v1/planner/agendas/items/?agenda_ids=1&agenda_ids=2"})," \u2014 Get items for multiple agendas; returns a dictionary keyed by agenda id"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/agendas/items/"})," \u2014 Create an agenda item"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"PUT /api/v1/planner/agendas/items/{item_id}/"})," \u2014 Update an agenda item"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"DELETE /api/v1/planner/agendas/items/{item_id}/"})," \u2014 Delete an agenda item"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/agendas/items/reorder/"})," \u2014 Reorder items within an agenda"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/agendas/items/{item_id}/copy/"})," \u2014 Copy an item (optionally to another agenda)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"POST /api/v1/planner/agendas/items/{item_id}/move/"})," \u2014 Move an item to another agenda"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"development",children:"Development"}),"\n",(0,a.jsx)(n.h3,{id:"project-structure",children:"Project Structure"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"app/"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"api/"})," \u2014 API endpoints and routers"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"core/"})," \u2014 config, DB"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"models/"})," \u2014 SQLAlchemy models"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"schemas/"})," \u2014 Pydantic models"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"services/"})," \u2014 business logic"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"tests/"})," \u2014 test suite"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"testing",children:"Testing"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"python -m pytest\n# or\npython -m pytest app/tests/test_services/test_user_service.py\n"})}),"\n",(0,a.jsx)(n.h3,{id:"database-migrations",children:"Database Migrations"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"./scripts/create_migration.sh <migration_name>\n# then\nalembic upgrade head\n"})}),"\n",(0,a.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,a.jsxs)(n.p,{children:["This project is licensed under the MIT License - see the ",(0,a.jsx)(n.a,{href:"https://github.com/dbtiunov/perga-api/blob/main/LICENSE",children:"LICENSE"})," file for details."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>r});var i=s(6540);const a={},l=i.createContext(a);function d(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:d(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);